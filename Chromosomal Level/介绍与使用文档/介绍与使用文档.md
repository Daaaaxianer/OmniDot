# 用于绘制基因组共线性（collinearity）和BLAST比对图

# 介绍

### 1，主要功能

- **BLAST模式**：显示基因间的一对一、一对多比对关系

- **共线性模式**：显示基因组间的共线性区块
- **组合模式**：可同时显示BLAST和共线性结果

### 2，主要工作流程

1. **数据读取与处理**
   - 读取GFF、染色体长度、比对结果等文件
   - 构建基因位置映射字典
   - 过滤和预处理比对数据
2. **坐标计算**
   - 根据选择的坐标系统（torder或tpos）计算基因位置
   - 处理染色体边界和标签位置
3. **图形生成**
   - 创建主比对图
   - 添加染色体边界、标签
   - 绘制比对点或共线性区块
   - 添加颜色条、图例等辅助元素
4. **布局调整**
   - 调整子图位置和大小
   - 处理重叠和间距
   - 保存最终图像

### 3，原理

核心原理是 **基因组比对数据的坐标映射和可视化**。

#### 1. **数据模型与坐标系统**

脚本支持两种基因定位方式：

##### a. **torder（基因顺序）坐标系统**

- **原理**：按基因在染色体上的顺序编号进行定位
- **计算方法**：基因在总坐标系中的位置 = 前序染色体上的基因总数 + 该基因在当前染色体上的顺序号
- **优点**：均匀分布，不受染色体大小影响
- **适用**：基因密度比较、共线性模式分析

##### b. **tpos（物理位置）坐标系统**

- **原理**：按基因在染色体上的实际物理位置（bp）进行定位
- **计算方法**：基因在总坐标系中的位置 = 前序染色体的总长度 + 该基因在当前染色体上的中点位置

- **优点**：反映真实物理距离
- **适用**：物理距离相关的分析、密度计算

#### 2. **染色体坐标系构建**

把所有染色体"首尾相接"地排列在一条直线上，构建了一个连续的坐标空间。

1号染色体的结尾下一位是2号染色体的开头。

```
n = 0  # 累积位置
for 每个染色体 in 物种1:
    染色体起始位置[染色体] = n
    n = n + 染色体长度[染色体]
    染色体标签位置[染色体] = 起始位置 + 染色体长度/2  # 用于显示染色体编号
```

#### 3. **数据映射原理**

```
query基因位置 = query基因所在的染色体起始位置 + query基因在染色体上的位置
subject基因位置 = subject基因所在的染色体起始位置 + subject基因在染色体上的位置
```

每个比对关系在图中表现为一个点：(query位置, subject位置)

#### 4.共线性区块的识别

1. **区块检测**：基于连续的基因对构建共线性区块
2. **区块合并**：根据距离阈值合并相邻的共线性区块
3. **Ks值整合**：计算区块内基因对的Ks统计值（平均值/中位数）

#### 5. **关键算法原理**

##### a. **共线性区块合并算法**

过滤小区块

合并两个距离相近的区块

##### b**对称性与半数显示原理**

当分析同一物种的自身比对时（如全基因组复制分析），比对图具有对称性。利用这一特性：在图上显示2个物种自身比对比对图









# 使用方法

## 一，文件格式

## GFF格式

| 列   | 信息      | 解释                        |
| ---- | --------- | --------------------------- |
| 1    | Chr       | 染色体                      |
| 2    | ID        | 基因名称                    |
| 3    | Start     | 基因的起始位置              |
| 4    | End       | 基因的末端位置              |
| 5    | Direction | 基因序列的方向              |
| 6    | Order     | 每条染色体的顺序，从 1 开始 |
| 7    | told_name | 原始 ID                     |

## lens

| 列   | 信息   | 解释           |
| ---- | ------ | -------------- |
| 1    | Chr    | 染色体         |
| 2    | Length | 染色体序列长度 |
| 3    | Number | 染色体基因数量 |

## Collinearity

```python
# Alignment 1: score=1451 pvalue=0.2214 N=49 1&1 plus
vivi01g00514 514 vivi01g00515 515 1
```

## KS

```python
id1 id2    ka_NG86    ks_NG86    ka_YN00    ks_YN00
vivi01g00514    vivi01g00515   0.0686 0.1182 0.0678 0.1258
vivi01g00517    vivi01g00516   0.0796 0.137  0.0835 0.1197
vivi01g00518    vivi01g00517   0.0278 0.0306 0.0299 0.0248
```

## color_dates

| 列   | 信息  | 解释           |
| ---- | ----- | -------------- |
| 1    | ID    | 基因名称       |
| 2    | color | 基因显示的颜色 |

## gene_show

| 列   | 信息 | 解释     |
| ---- | ---- | -------- |
| 1    | Chr  | 染色体   |
| 2    | ID   | 基因名称 |



## 二，配置文件

## config.toml

### 格式（toml）

使用表分割不同的功能

表是键值对的集合，用方括号表示

配置文件中所有的文件地址都用单引号 ' ' 包括

```toml
[blast]
half = "False"
mods = "blast"
blast_name = 'D:\Python_cod\vivi_coca.1e-5.blast'
...
[Collinearity]
half = "False"
mods = "collinearity"
Collinearity = 'D:\Python_cod\vivi_coca.collinearity_new.txt'
...
```

### [blast]

画blast时的标准格式

```toml
[blast]
half = "False"
mods = "blast"
mod = "torder"  
blast_name = 'D:\Python_cod\vivi_coca.1e-5.blast'  
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens'  
name_1 = "V.vinifera" 
name_2 = "C.canephora" 
mod_show = "nan"    
bin_sizes = 20 
wide = 400  
longs = 350  
color_date = "False"  
gene_show = 'D:\Python_cod\vivi_coca_gene.gff'  
color_dates = 'D:\Python_cod\vivi_coca_c.gff'  
savefile= 'graph39_11.png'   
```

解释：

```toml
half = "False"
```

默认参数，不变或不写

```toml
mods = "blast"
```

默认参数，不变

```toml
mod = "torder"
```

"torder"或"tpos"        

根据gff文件的 tpos 或 torder 画图 "torder" 根据基因在染色体总的基因上的相对顺序 "tpos" 根据基因在染色体上的真实位置

```toml
blast_name = 'D:\Python_cod\vivi_coca.1e-5.blast'  
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens
```

写入blast文件的路径

写入blast第1列的gff文件的路径

写入blast第2列的gff文件的路径

写入blast第1列的lens文件的路径

写入blast第2列的lens文件的路径

```toml
name_1 = "V.vinifera" 
name_2 = "C.canephora" 
```

写入blast第1列物种名称

写入blast第2列物种名称

```toml
mod_show = "nan"    
```

"tree" ,"density" ,"nan"    

 "nan" 都不显示    "tree" 显示特定基因的名称  "density"显示基因的密度

```toml
bin_sizes = 20  
```

mod_show ="density"下定义分箱大小  默认单位为百万 值越小细节越丰富

bin_sizes = 20  分箱大小为 20M

```toml
wide = 400  
longs = 350  
```

mod_show ="tree"情况下控制显示的名称上下的距离差

mod_show ="tree"情况下控制显示的名称左右的距离差 

```toml
color_date = "False"  
```

"False" "True"

mod_show ="tree"情况下是否有显示基因名称的连接线的颜色文件 

```toml
gene_show = 'D:\Python_cod\vivi_coca_gene.gff'  
color_dates = 'D:\Python_cod\vivi_coca_c.gff'  
```

写入mod_show ="tree"情况下显示的基因名称的文件路径

写入mod_show ="tree"且color_date = "True"情况下显示的基因名称对应颜色的文件路径  

```toml
savefile= 'graph39_11.png'    
```

写入最后产生的图片路径



##### 例图：

mod_show ="density"：

![graph39_3](./graph39_3.png)

mod_show ="tree"
color_date = "False"：

![graph39_10](./graph39_10.png)

mod_show ="tree"
color_date = "True"：

![graph39_9](./graph39_9.png)

### [Collinearity]

画Collinearity时的标准格式

```toml
[Collinearity]
half = "False"
mods = "collinearity"
mod = "torder"  
Collinearity = 'D:\Python_cod\vivi_coca.collinearity_new.txt'   
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens' 
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens'  
name_1 = "V.vinifera"  
name_2 = "C.canephora"  
mod_show = "nan"  
bin_sizes = 20  
name_3 = "one Vivi : Coca" 
name_4 = "one Coca : Vivi"
gene_show = 'D:\Python_cod\vivi_coca_gene.gff'  
wide = 400  
longs = 350  
color_date = "False"  
color_dates = 'D:\Python_cod\vivi_coca_c.gff'  
collinearity_ks_mod = "True"  
Collinearity_ks = 'D:\Python_cod\vivi_coca.collinearity.ks.txt' 
Ks = "True"  
ks_mod = "Median"  
name_id = "False"  
N = 5  
NSD = 10  
Distance = 250  
savefile= 'graph39_11.png'   
```

解释：

```toml
half = "False"
```

默认参数，不变

```toml
mods = "collinearity"
```

默认参数，不变

```toml
mod = "torder"
```

"torder"或"tpos"        

根据gff文件的 tpos 或 torder 画图 "torder" 根据基因在染色体总的基因上的相对顺序 "tpos" 根据基因在染色体上的真实位置

```toml
Collinearity = 'D:\Python_cod\vivi_coca.collinearity_new.txt'
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens
```

写入collinearity文件路径

写入collinearity第1列的gff文件的路径

写入collinearity第2列的gff文件的路径

写入collinearity第1列的lens文件的路径

写入collinearity第2列的lens文件的路径

```toml
name_1 = "V.vinifera" 
name_2 = "C.canephora" 
```

写入blast第1列物种名称

写入blast第2列物种名称

```
mod_show = "nan" 
```

"rate","tree","density","nan"

"rate"显示基因的比例 "tree"显示特定基因的名称 "density"显示基因的密度 "nan"都不显示

```toml
bin_sizes = 20  
```

mod_show ="density"下定义分箱大小  默认单位为百万 值越小细节越丰富

bin_sizes = 20  分箱大小为 20M

```toml
wide = 400  
longs = 350  
```

mod_show ="tree"情况下控制显示的名称上下的距离差

mod_show ="tree"情况下控制显示的名称左右的距离差 

```toml
color_date = "False"  
```

"False" "True"

mod_show ="tree"情况下是否有显示基因名称的连接线的颜色文件 

```toml
gene_show = 'D:\Python_cod\vivi_coca_gene.gff'  
color_dates = 'D:\Python_cod\vivi_coca_c.gff'  
```

写入mod_show ="tree"情况下显示的基因名称的文件路径

写入mod_show ="tree"且color_date = "True"情况下显示的基因名称对应颜色的文件路径  

```toml
name_3 = "one Vivi : Coca" 
name_4 = "one Coca : Vivi" 
```

在mod_show="rate"下需要填写显示基因的比例的名称 第1列：第2列

在mod_show="rate"下需要填写显示基因的比例的名称 第2列：第1列

```toml
collinearity_ks_mod = "True"  
```

"False" "True"   

是否输入ks文件 

```toml
Collinearity_ks = 'D:\Python_cod\vivi_coca.collinearity.ks.txt'
```

collinearity_ks_mod="True"情况下 写入ks文件路径

```toml
Ks = "True"  
```

"False" "True"

collinearity_ks_mod="True"情况下是否显示ks的值

```toml
ks_mod = "Median"
```

 "Average" 或 "Median"  

collinearity_ks_mod="True"情况下 "Average"显示ks的平均数"Median"显示ks的中位数

```toml
name_id = "False"  
```

"True", "False" 

是否去除物种自身比较时的对角线 (当并非是物种自身比较时 应为 "False" )

```toml
N = 5 
NSD = 10  
Distance = 250 
```

最小对齐数阈值 ≥N 个对齐的区块才合并

显示阈值 ≥NSD 个对齐的区块才显示

区块合并距离 相对顺序差＜250 的区块合并

```toml
savefile= 'graph39_11.png'    
```

写入最后产生的图片路径

##### 例图：

mod_show = "rate"

Ks = "True"

![graph39_6](./graph39_6.png)

mod_show = "rate"

Ks = "False"

![graph27_5](./graph27_5.png)

### [blast_blast]

将2个自身与自身blast比对图以三角形拼接到一起

画blast_blast时的标准格式

```toml
[blast_blast]
half = "self_col_2"
mods = "blast"
mod = "torder" 
blast_name = 'D:\Python_cod\vivi_coca.1e-5.blast'  
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens'  
blast_name_2= 'D:\Python_cod\coca_coca.1e-5.blast'  
blast_gff_1_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_gff_2_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1_2 = 'D:\Python_cod\blast文件\coca.lens' 
blast_lens_2_2 = 'D:\Python_cod\blast文件\coca.lens' 
name_1 = "V.vinifera"  
name_2 = "C.canephora" 
name_1_4 = "B.hispida" 
name_2_4 = "B.hispida"  
posd = "bot_left"  
savefile= 'graph39_11.png'   
```

解释：

```toml
half = "self_col_2"
```

默认参数，不变

```toml
mods = "blast"
```

默认参数，不变

```toml
mod = "torder"
```

"torder"或"tpos"        

根据gff文件的 tpos 或 torder 画图 "torder" 根据基因在染色体总的基因上的相对顺序 "tpos" 根据基因在染色体上的真实位置

```toml
blast_name = 'D:\Python_cod\vivi_coca.1e-5.blast'  
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens
blast_name_2= 'D:\Python_cod\coca_coca.1e-5.blast'  
blast_gff_1_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_gff_2_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1_2 = 'D:\Python_cod\blast文件\coca.lens' 
blast_lens_2_2 = 'D:\Python_cod\blast文件\coca.lens' 
```

写入blast文件的路径

写入blast第1列的gff文件的路径

写入blast第2列的gff文件的路径

写入blast第1列的lens文件的路径

写入blast第2列的lens文件的路径

写入第2个blast文件的路径

写入第2个blast第1列的gff文件的路径

写入第2个blast第2列的gff文件的路径

写入第2个blast第1列的lens文件的路径

写入第2个blast第2列的lens文件的路径

```toml
name_1 = "V.vinifera" 
name_2 = "C.canephora" 
name_1_4 = "B.hispida"  
name_2_4 = "B.hispida" 
```

写入blast第1列物种名称

写入blast第2列物种名称

写入第2个blast第1列物种名称

写入第2个blast第2列物种名称

```toml
posd = "bot_left" 
```

"bot_left"   "bot_right"

图像的格式，第一幅图在左上方还是左下方

```toml
savefile= 'graph39_11.png'    
```

写入最后产生的图片路径

例图：

![graph39_1.Median](./graph39_1.Median.png)

### [Collinearity_Collinearity]

将2个自身与自身Collinearity比对图以三角形拼接到一起

画Collinearity_Collinearity时的标准格式

```toml
[Collinearity_Collinearity]
half = "self_col_2"
mods = "collinearity"
mod = "torder"
Collinearity = 'D:\Python_cod\vivi_coca.collinearity_new.txt'   
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens'  
Collinearity_2='D:\Python_cod\coca_coca.collinearity.txt'  
blast_gff_1_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_gff_2_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1_2 = 'D:\Python_cod\blast文件\coca.lens' 
blast_lens_2_2 = 'D:\Python_cod\blast文件\coca.lens' 
name_1 = "V.vinifera"  
name_2 = "C.canephora"  
name_1_4 = "B.hispida" 
name_2_4 = "B.hispida"  
posd = "bot_left"  
collinearity_ks_mod = "True"  
Collinearity_ks = 'D:\Python_cod\vivi_coca.collinearity.ks.txt'  
Collinearity_ks_2= 'D:\Python_cod\coca_coca.collinearity.ks.txt'  
Ks = "False" 
ks_mod = "Median"  
name_id = "False"  
N = 5  
NSD = 10  
Distance = 250  
block = "True" 
top_block = "True"  
ks_dem_1 = 1.5  
ks_dem_1_1=0.8  
ks_dem_2 = 1.8  
ks_dem_2_2= 1.2 
savefile= 'graph39_11.png'  
```

解释：

```toml
half = "self_col_2"
```

默认参数，不变

```toml
mods = "collinearity"
```

默认参数，不变

```toml
mod = "torder"
```

"torder"或"tpos"        

根据gff文件的 tpos 或 torder 画图 "torder" 根据基因在染色体总的基因上的相对顺序 "tpos" 根据基因在染色体上的真实位置

```toml
Collinearity = 'D:\Python_cod\vivi_coca.collinearity_new.txt'  
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens
Collinearity_2='D:\Python_cod\coca_coca.collinearity.txt' 
blast_gff_1_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_gff_2_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1_2 = 'D:\Python_cod\blast文件\coca.lens' 
blast_lens_2_2 = 'D:\Python_cod\blast文件\coca.lens' 
```

写入Collinearity文件的路径

写入Collinearity第1列的gff文件的路径

写入Collinearity第2列的gff文件的路径

写入blast第1列的lens文件的路径

写入Collinearity第2列的lens文件的路径

写入第2个Collinearity文件的路径

写入第2个Collinearity第1列的gff文件的路径

写入第2个Collinearity第2列的gff文件的路径

写入第2个Collinearity第1列的lens文件的路径

写入第2个Collinearity第2列的lens文件的路径

```toml
name_1 = "V.vinifera" 
name_2 = "C.canephora" 
name_1_4 = "B.hispida"  
name_2_4 = "B.hispida" 
```

写入Collinearity第1列物种名称

写入Collinearity第2列物种名称

写入第2个Collinearity第1列物种名称

写入第2个Collinearity第2列物种名称

```toml
posd = "bot_left" 
```

"bot_left"   "bot_right"

图像的格式，第一幅图在左上方还是左下方

```toml
collinearity_ks_mod = "True"  
```

"False" "True"   

是否输入ks文件 

```toml
Collinearity_ks = 'D:\Python_cod\vivi_coca.collinearity.ks.txt'
Collinearity_ks_2= 'D:\Python_cod\coca_coca.collinearity.ks.txt'
```

collinearity_ks_mod="True"情况下 写入第1个ks文件路径

collinearity_ks_mod="True"情况下 写入第2个ks文件路径

```toml
Ks = "True"  
```

"False" "True"

collinearity_ks_mod="True"情况下是否显示ks的值

```toml
ks_mod = "Median"
```

 "Average" 或 "Median"  

collinearity_ks_mod="True"情况下 "Average"显示ks的平均数"Median"显示ks的中位数

```toml
name_id = "False"  
```

"True", "False" 

是否去除物种自身比较时的对角线 (当并非是物种自身比较时 应为 "False" )

```toml
N = 5 
NSD = 10  
Distance = 250 
```

最小对齐数阈值 ≥N 个对齐的区块才合并

显示阈值 ≥NSD 个对齐的区块才显示

区块合并距离 相对顺序差＜250 的区块合并

```toml
block = "True"  
```

"False" "True"  

是否显示 block 的大小

```toml
top_block = "True"  
```

"False" "True"

在collinearity_ks_mod="True" 且Ks="False" 情况下  是否突出显示最近的一次加倍 需要ks文件

```
ks_dem_1 = 1.5  
ks_dem_1_1=0.8  
ks_dem_2 = 1.8 
ks_dem_2_2= 1.2 
```

top_block= "True"情况下 分割第一幅图最近的一次加倍的ks的上限

top_block= "True"情况下 分割第一幅图最近的一次加倍的ks的上限

top_block ="True"情况下 分割第二幅图最近的一次加倍的ks的上限

top_block ="True"情况下 分割第二幅图最近的一次加倍的ks的上限



```toml
savefile= 'graph39_11.png'    
```

写入最后产生的图片路径

例图：

block = "True" 

top_block = "True"

 ![graph39_2.Median](./graph39_2.Median.png)

block = "True" 

top_block = "False" 

![graph39_4](./graph39_4.png)

collinearity_ks_mod = "False"

block = "True" 

![graph34_4](./graph34_4.png)

### [blast_Collinearity]

将1个自身与自身blast比对与将1个自身与自身Collinearity比对图以三角形拼接到一起

画blast_Collinearity时的标准格式

```toml
[blast_Collinearity]
half = "self_blco_2"
mods = "blast"
mod = "torder"  
blast_name = 'D:\Python_cod\coca_coca.1e-5.blast'  
blast_gff_1 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\coca.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens'  
Collinearity_2='D:\Python_cod\coca_coca.collinearity.txt' 
blast_gff_1_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_gff_2_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1_2 = 'D:\Python_cod\blast文件\coca.lens' 
blast_lens_2_2 = 'D:\Python_cod\blast文件\coca.lens' 
name_1 = "C.canephora"  
name_2 = "C.canephora"  
name_1_4 = "C.canephora"  
name_2_4 = "C.canephora"  
posd = "bot_left"  
collinearity_ks_mod = "False"  
Collinearity_ks_2= 'D:\Python_cod\coca_coca.collinearity.ks.txt'  
Ks = "False"  
ks_mod = "Median"  
name_id = "True"  
N = 5  
NSD = 10  
Distance = 250  
block = "True"  
top_block = "False"  
ks_dem_1 = 1.5  
ks_dem_1_1=0.8  
ks_dem_2 = 1.8  
ks_dem_2_2= 1.2 
savefile= 'graph39_11.png'   
```

解释：

```toml
half = "self_col_2"
```

默认参数，不变

```toml
mods = "blast"
```

默认参数，不变

```toml
mod = "torder"
```

"torder"或"tpos"        

根据gff文件的 tpos 或 torder 画图 "torder" 根据基因在染色体总的基因上的相对顺序 "tpos" 根据基因在染色体上的真实位置

```toml
blast_name = 'D:\Python_cod\vivi_coca.1e-5.blast'  
blast_gff_1 = 'D:\Python_cod\vivi.new.gff'  
blast_gff_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1 = 'D:\Python_cod\blast文件\vivi.lens'  
blast_lens_2 = 'D:\Python_cod\blast文件\coca.lens
Collinearity_2= 'D:\Python_cod\coca_coca.1e-5.blast' 
blast_gff_1_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_gff_2_2 = 'D:\Python_cod\blast例子\Data\coca.new.gff'  
blast_lens_1_2 = 'D:\Python_cod\blast文件\coca.lens' 
blast_lens_2_2 = 'D:\Python_cod\blast文件\coca.lens' 
```

写入blast文件的路径

写入blast第1列的gff文件的路径

写入blast第2列的gff文件的路径

写入blast第1列的lens文件的路径

写入blast第2列的lens文件的路径

写入第2个Collinearity文件的路径

写入第2个Collinearity第1列的gff文件的路径

写入第2个Collinearity第2列的gff文件的路径

写入第2个Collinearity第1列的lens文件的路径

写入第2个Collinearity第2列的lens文件的路径

```toml
name_1 = "V.vinifera" 
name_2 = "C.canephora" 
name_1_4 = "B.hispida"  
name_2_4 = "B.hispida" 
```

写入blast第1列物种名称

写入blast第2列物种名称

写入第2个Collinearity第1列物种名称

写入第2个Collinearity第2列物种名称

```toml
posd = "bot_left" 
```

"bot_left"   "bot_right"

图像的格式，第一幅图在左上方还是左下方

```toml
collinearity_ks_mod = "True"  
```

"False" "True"   

是否输入ks文件 

```toml
Collinearity_ks_2= 'D:\Python_cod\coca_coca.collinearity.ks.txt'
```

collinearity_ks_mod="True"情况下 写入第2个ks文件路径

```toml
Ks = "True"  
```

"False" "True"

collinearity_ks_mod="True"情况下是否显示ks的值

```toml
ks_mod = "Median"
```

 "Average" 或 "Median"  

collinearity_ks_mod="True"情况下 "Average"显示ks的平均数"Median"显示ks的中位数

```toml
name_id = "False"  
```

"True", "False" 

是否去除物种自身比较时的对角线 (当并非是物种自身比较时 应为 "False" )

```toml
N = 5 
NSD = 10  
Distance = 250 
```

最小对齐数阈值 ≥N 个对齐的区块才合并

显示阈值 ≥NSD 个对齐的区块才显示

区块合并距离 相对顺序差＜250 的区块合并

```toml
block = "True"  
```

"False" "True"  

是否显示 block 的大小

```toml
top_block = "True"  
```

"False" "True"

在collinearity_ks_mod="True" 且Ks="False" 情况下  是否突出显示最近的一次加倍 需要ks文件

```
ks_dem_1 = 1.5  
ks_dem_1_1=0.8  
ks_dem_2 = 1.8 
ks_dem_2_2= 1.2 
```

top_block= "True"情况下 分割第一幅图最近的一次加倍的ks的上限

top_block= "True"情况下 分割第一幅图最近的一次加倍的ks的上限

top_block ="True"情况下 分割第二幅图最近的一次加倍的ks的上限

top_block ="True"情况下 分割第二幅图最近的一次加倍的ks的上限

```toml
savefile= 'graph39_11.png'    
```

写入最后产生的图片路径

例图：

![graph39_11](./graph39_11.png)